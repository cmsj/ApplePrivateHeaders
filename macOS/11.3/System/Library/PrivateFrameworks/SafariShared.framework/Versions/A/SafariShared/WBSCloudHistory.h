/*
* This header is generated by classdump-dyld 1.0
* on Wednesday, April 28, 2021 at 2:51:52 PM British Summer Time
* Operating System: Version 11.3 (Build 20E232)
* Image Source: /System/Library/PrivateFrameworks/SafariShared.framework/Versions/A/SafariShared
* classdump-dyld is licensed under GPLv3, Copyright Â© 2013-2016 by Elias Limneos.
*/

#import <SafariShared/SafariShared-Structs.h>
#import <libobjc.A.dylib/WBSCloudHistoryServiceProtocol.h>
#import <libobjc.A.dylib/WBSCloudKitThrottlerDataStore.h>

@protocol OS_dispatch_queue, WBSHistoryServiceDatabaseProtocol, WBSCloudHistoryDataStore, WBSCloudKitContainerManateeObserving;
@class NSObject, NSData, WBSCloudHistoryConfiguration, WBSCloudKitThrottler, WBSOneShotTimer, WBSCloudHistoryPushAgentProxy, NSMutableDictionary, NSMutableArray, NSString;

@interface WBSCloudHistory : NSObject <WBSCloudHistoryServiceProtocol, WBSCloudKitThrottlerDataStore> {

	NSObject*<OS_dispatch_queue> _cloudHistoryQueue;
	id<WBSHistoryServiceDatabaseProtocol> _database;
	NSData* _pushThrottlerData;
	NSData* _fetchThrottlerData;
	NSData* _syncCircleSizeRetrievalThrottlerData;
	NSData* _longLivedSaveOperationData;
	unsigned long long _syncCircleSize;
	char _cloudHistoryEnabled;
	char _saveChangesWhenHistoryLoads;
	char _fetchChangesWhenHistoryLoads;
	unique_ptr<SafariShared::SuddenTerminationDisabler, std::__1::default_delete<SafariShared::SuddenTerminationDisabler>>* _saveOperationSuddenTerminationDisabler;
	unique_ptr<SafariShared::SuddenTerminationDisabler, std::__1::default_delete<SafariShared::SuddenTerminationDisabler>>* _fetchOperationSuddenTerminationDisabler;
	unique_ptr<SafariShared::SuddenTerminationDisabler, std::__1::default_delete<SafariShared::SuddenTerminationDisabler>>* _replayLongLivedSaveOperationSuddenTerminationDisabler;
	char _replayLongLivedSaveOperationHasBeenPerformed;
	WBSCloudHistoryConfiguration* _configuration;
	id<WBSCloudHistoryDataStore> _store;
	WBSCloudKitThrottler* _saveChangesThrottler;
	WBSCloudKitThrottler* _fetchChangesThrottler;
	WBSCloudKitThrottler* _syncCircleSizeRetrievalThrottler;
	WBSOneShotTimer* _serverBackoffTimer;
	char _saveChangesWhenBackoffTimerFires;
	char _fetchChangesWhenBackoffTimerFires;
	WBSCloudHistoryPushAgentProxy* _pushAgent;
	WBSOneShotTimer* _pushNotificationFetchTimer;
	unsigned long long _numberOfDevicesInSyncCircle;
	NSMutableDictionary* _syncCircleSizeRetrievalCompletionHandlersByOperation;
	/*^block*/id _fetchCompletionHandler;
	/*^block*/id _saveCompletionHandler;
	id<WBSCloudKitContainerManateeObserving> _containerManateeObserver;
	NSMutableArray* _storeDeterminationCompletionBlocks;
	long long _currentManateeState;
	char _manateeStateNeedsUpdate;
	char _isWaitingForPCSIdentityUpdate;
	char _determiningStoreType;
	char _removedHistoryItemsArePendingSave;

}

@property (assign,nonatomic) unsigned long long numberOfDevicesInSyncCircle;                     //@synthesize numberOfDevicesInSyncCircle=_numberOfDevicesInSyncCircle - In the implementation block
@property (assign,getter=isCloudHistoryEnabled,nonatomic) char cloudHistoryEnabled; 
@property (assign,nonatomic) char removedHistoryItemsArePendingSave;                             //@synthesize removedHistoryItemsArePendingSave=_removedHistoryItemsArePendingSave - In the implementation block
@property (readonly) unsigned long long hash; 
@property (readonly) Class superclass; 
@property (copy,readonly) NSString * description; 
@property (copy,readonly) NSString * debugDescription; 
-(void)dealloc;
-(id)initWithDatabase:(id)arg1 configuration:(id)arg2 completionBlock:(/*^block*/id)arg3 ;
-(char)_hasCloudHistoryEntitlement;
-(void)_determineCloudHistoryStoreWithCompletion:(/*^block*/id)arg1 ;
-(id)_currentSaveChangesThrottlerPolicyString;
-(id)_currentFetchChangesThrottlerPolicyString;
-(id)_currentSyncCircleSizeRetrievalThrottlerPolicyString;
-(void)_replayPersistedLongLivedSaveOperationIfNecessary;
-(void)_pruneTombstonesThatCanNoLongerMatchVisitsFetchedFromCloud;
-(void)_initializePushNotificationSupport;
-(void)_performBlockAsynchronouslyOnCloudHistoryQueueAfterHistoryHasLoaded:(/*^block*/id)arg1 ;
-(void)_cloudHistoryConfigurationChanged:(id)arg1 ;
-(void)_pushNotificationReceived:(id)arg1 ;
-(void)_transitionCloudHistoryStoreToManateeState:(long long)arg1 completion:(/*^block*/id)arg2 ;
-(void)saveChangesBypassingThrottler:(char)arg1 completionHandler:(/*^block*/id)arg2 ;
-(void)_postSaveChangesAttemptCompletedNotificationWithAllPendingDataSaved:(char)arg1 ;
-(void)_callAndResetSaveCompletionHandlerWithError:(id)arg1 ;
-(char)isCloudHistoryEnabled;
-(void)_registerSaveCompletionHandler:(/*^block*/id)arg1 ;
-(void)_determineNumberOfDevicesInSyncCircleForOperation:(id)arg1 completionHandler:(/*^block*/id)arg2 ;
-(void)_persistLongLivedSaveOperationDictionaryWithOperationID:(id)arg1 databaseGeneration:(long long)arg2 ;
-(void)_removePersistedLongLivedSaveOperationDictionary;
-(void)_handleManateeErrorIfNeeded:(id)arg1 ;
-(void)_resetForAccountChangeWithCompletionHandler:(/*^block*/id)arg1 ;
-(double)_backoffTimeIntervalFromError:(id)arg1 ;
-(void)_backOffWithInterval:(double)arg1 ;
-(void)_saveVisits:(id)arg1 tombstones:(id)arg2 toCloudHistoryBypassingThrottler:(char)arg3 longLivedOperationPersistenceCompletion:(/*^block*/id)arg4 withCallback:(/*^block*/id)arg5 ;
-(void)getVisitsAndTombstonesNeedingSyncWithVisitSyncWindow:(double)arg1 completion:(/*^block*/id)arg2 ;
-(long long)_priorityForSaveWithVisits:(id)arg1 tombstones:(id)arg2 bypassingThrottler:(char)arg3 ;
-(long long)_resultFromError:(id)arg1 ;
-(long long)_estimatedPriorityForPotentialSaveAttempt;
-(void)fetchAndMergeChangesBypassingThrottler:(char)arg1 completionHandler:(/*^block*/id)arg2 ;
-(void)_registerFetchCompletionHandler:(/*^block*/id)arg1 ;
-(void)_callAndResetFetchCompletionHandlerWithError:(id)arg1 ;
-(void)_fetchAndMergeChangesWithServerChangeTokenData:(id)arg1 withPriority:(long long)arg2 ;
-(void)_getServerChangeTokenDataWithCompletion:(/*^block*/id)arg1 ;
-(void)fetchAndMergeChanges;
-(void)saveChangesToCloudHistoryStore;
-(id)_manateeErrorCode:(id)arg1 ;
-(void)_deleteAllCloudHistoryAndSaveAgain;
-(void)_pcsIdentitiesChangedNotification:(id)arg1 ;
-(void)_setServerChangeToken:(id)arg1 ;
-(void)_processPendingPushNotifications;
-(void)_persistedLongLivedSaveOperationID:(id*)arg1 databaseGeneration:(long long*)arg2 ;
-(void)_updateHistoryAfterSuccessfulPersistedLongLivedSaveOperationWithGeneration:(long long)arg1 completion:(/*^block*/id)arg2 ;
-(void)_setPushNotificationAreInitialized:(char)arg1 ;
-(void)_pushNotificationsAreInitializedWithCompletionHandler:(/*^block*/id)arg1 ;
-(void)_updateDeviceCountInResponseToPushNotification;
-(void)_fetchChangesInResponseToPushNotification:(id)arg1 ;
-(unsigned long long)_cachedNumberOfDevicesInSyncCircle;
-(void)setNumberOfDevicesInSyncCircle:(unsigned long long)arg1 ;
-(void)_registerForHistoryWasLoadedNotificationIfNecessary;
-(void)_serverBackoffTimerFired:(id)arg1 ;
-(void)_updateThrottlerPolicies;
-(void)_setCachedNumberOfDevicesInSyncCircle:(unsigned long long)arg1 ;
-(void)_resetCloudHistoryDataWithCompletionHandler:(/*^block*/id)arg1 ;
-(id)dateOfNextPermittedSaveChangesAttempt;
-(void)updateConfiguration:(id)arg1 completionHandler:(/*^block*/id)arg2 ;
-(void)resetForAccountChangeWithCompletionHandler:(/*^block*/id)arg1 ;
-(void)fetchDateOfNextPermittedSaveChangesAttemptWithCompletionHandler:(/*^block*/id)arg1 ;
-(id)recordOfPastOperationsForThrottler:(id)arg1 ;
-(void)setRecordOfPastOperations:(id)arg1 forThrottler:(id)arg2 ;
-(id)initWithDatabase:(id)arg1 configuration:(id)arg2 ;
-(void)setCloudHistoryEnabled:(char)arg1 ;
-(void)saveChangesToCloudHistoryStoreBypassingThrottler;
-(void)fetchAndMergeChangesBypassingThrottler;
-(void)_saveChangesWhenHistoryLoads;
-(void)_fetchChangesWhenHistoryLoads;
-(void)resetForAccountChange;
-(char)removedHistoryItemsArePendingSave;
-(void)setRemovedHistoryItemsArePendingSave:(char)arg1 ;
-(unsigned long long)numberOfDevicesInSyncCircle;
@end

